<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† - IndexedDB</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f4f8;
      padding: 20px;
      direction: rtl;
      color: #333;
    }
    h2 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 30px;
    }
    .section {
      background: #ffffff;
      padding: 20px 25px;
      margin-bottom: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .form-row {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      align-items: center;
      justify-content: flex-start;
    }
    .form-group {
      flex: 1 1 180px;
      min-width: 150px;
      display: flex;
      flex-direction: column;
    }
    label {
      font-weight: 600;
      margin-bottom: 6px;
      color: #34495e;
      user-select: none;
    }
    input[type="text"],
    input[type="date"],
    select {
      padding: 10px 12px;
      border: 1.8px solid #d1dce5;
      border-radius: 8px;
      font-size: 16px;
      transition: border-color 0.3s ease;
    }
    input[type="text"]:focus,
    input[type="date"]:focus,
    select:focus {
      border-color: #3498db;
      outline: none;
      box-shadow: 0 0 6px #a8d0f0;
    }
    button {
      padding: 12px 20px;
      background-color: #3498db;
      border: none;
      border-radius: 8px;
      color: white;
      font-weight: 700;
      cursor: pointer;
      transition: background-color 0.3s ease;
      min-width: 140px;
      user-select: none;
    }
    button:hover {
      background-color: #2c80c9;
    }
    .table-container {
      max-height: 290px; /* Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ù„Ù„ØªÙ…Ø±ÙŠØ± */
      overflow-y: auto;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-top: 15px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      font-size: 14px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      /* ØªÙ…Øª Ø¥Ø²Ø§Ù„Ø© overflow:hidden Ù…Ù† Ù‡Ù†Ø§ */
      border-radius: 0; /* Ù„Ø§ ØªØ¹Ø·ÙŠ border-radius Ù‡Ù†Ø§ */
    }
    thead tr {
      background-color: #2980b9;
      color: white;
      user-select: none;
    }
    thead th {
      position: sticky;
      top: 0;
      background-color: #2980b9;
      z-index: 10;
    }
    th, td {
      padding: 12px 8px;
      text-align: center;
      border-bottom: 1px solid #e1e9f0;
      vertical-align: middle;
    }
    tbody td {
      font-size: 18px;
    }
    tbody tr:hover {
      background-color: #eaf4fb;
    }
    tbody tr:last-child td {
      border-bottom: none;
    }
.btn-small {
  padding: 2px 8px;
  font-size: 12px;
  border-radius: 4px;
  user-select: none;
  border: none;
  cursor: pointer;
  margin: 2px 2px;
  min-width: 75px;
  height: 28px;
  line-height: 28px; /* Ù†ÙØ³ Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø²Ø± */
  box-sizing: border-box;
}


<pre><code>.btn-edit {
  background-color: #27ae60;
  color: white;
}
.btn-edit:hover {
  background-color: #1e8449;
}
.btn-delete {
  background-color: #e74c3c;
  color: white;
}
.btn-delete:hover {
  background-color: #c0392b;
}
.btn-details {
  background-color: #f39c12;
  color: white;
}
.btn-details:hover {
  background-color: #d68910;
}
.btn-print {
  background-color: #8e44ad;
  color: white;
}
.btn-print:hover {
  background-color: #732d91;
}
@media (max-width: 720px) {
  .form-row {
    flex-direction: column;
  }
  .form-group {
    width: 100%;
  }
  button {
    width: 100%;
    min-width: auto;
  }
  table, thead, tbody, th, td, tr {
    display: block;
  }
  thead tr {
    position: absolute;
    top: -9999px;
    left: -9999px;
  }
  tr {
    margin-bottom: 15px;
  }
  td {
    border: none;
    position: relative;
    padding-left: 50%;
    text-align: right;
  }
  td:before {
    position: absolute;
    top: 12px;
    left: 10px;
    width: 45%;
    white-space: nowrap;
    font-weight: 600;
    color: #555;
  }
  td:nth-of-type(1):before { content: &quot;Ø§Ù„Ø±Ù‚Ù…&quot;; }
  td:nth-of-type(2):before { content: &quot;Ø§Ù„Ø§Ø³Ù…&quot;; }
  td:nth-of-type(3):before { content: &quot;Ø§Ù„Ø¬Ù†Ø³&quot;; }
  td:nth-of-type(4):before { content: &quot;Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©&quot;; }
  td:nth-of-type(5):before { content: &quot;ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯&quot;; }
  td:nth-of-type(6):before { content: &quot;Ø§Ù„ÙŠÙˆÙ…&quot;; }
  td:nth-of-type(7):before { content: &quot;Ø§Ù„ÙˆÙ‚Øª&quot;; }
  td:nth-of-type(8):before { content: &quot;ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„&quot;; }
  td:nth-of-type(9):before { content: &quot;ØªØ­ÙƒÙ…&quot;; }
}
/* Ù†Ø§ÙØ°Ø© ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù */
#editModal {
  display: none;
  position: fixed;
  z-index: 1000;
  left: 0; top: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.5);
}
#editModalContent {
  background: #fff;
  width: 350px;
  margin: 100px auto;
  padding: 20px;
  border-radius: 10px;
  position: relative;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}
#editModalContent span.closeBtn {
  position: absolute;
  top: 10px; left: 15px;
  font-size: 22px;
  cursor: pointer;
}
#editModalContent h3 {
  text-align: center;
  margin-bottom: 20px;
}
#editModalContent form input,
#editModalContent form select {
  width: 100%;
  padding: 8px;
  margin-bottom: 10px;
  font-size: 15px;
  border-radius: 6px;
  border: 1.5px solid #d1dce5;
  box-sizing: border-box;
}
#editModalContent form button {
  width: 100%;
  padding: 10px;
  background: #27ae60;
  color: #fff;
  font-weight: bold;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 16px;
}
#editModalContent form button:hover {
  background: #1e8449;
}
#successMessage {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background-color: #27ae60;
  color: white;
  padding: 12px 20px;
  border-radius: 10px;
  font-size: 18px;
  font-weight: bold;
  z-index: 9999;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
  transition: opacity 0.4s ease;
  text-align: center;
}
#matchingNames li {
  padding: 8px 12px;
  border-bottom: 1px solid #eee;
}

#matchingNames li:hover {
  background-color: #3498db;
  color: white;
}

<p>  </style></p>
</head>
<body>


<!-- Ù†Ø§ÙØ°Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø£Ù†ÙŠÙ‚Ø© -->
<div id="loginModal" style="position:fixed; z-index:9999; top:0; left:0; width:100%; height:100%; background:linear-gradient(to bottom, #2c3e50, #34495e); display:flex; justify-content:center; align-items:center; font-family:'Arial', sans-serif;">
  <div style="background:#fff; padding:30px; border-radius:20px; box-shadow:0 0 30px rgba(0,0,0,0.4); width:100%; max-width:350px; text-align:center;">
    <h2 style="margin-bottom:25px; color:#2c3e50;">ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
    
    <div style="display:flex; flex-direction:column; align-items:center;">
<input type="text" id="loginUsername" placeholder="ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" 
       style="width:90%; padding:12px; margin-bottom:15px; border-radius:10px; border:1px solid #ccc; font-size:16px;" />

      
      <input type="password" id="loginPassword" placeholder="ğŸ”‘ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" 
             style="width:90%; padding:12px; margin-bottom:8px; border-radius:10px; border:1px solid #ccc; font-size:16px;" />
      
      <!-- Ù…Ø±Ø¨Ø¹ Ø¥Ø¸Ù‡Ø§Ø± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± -->
      <label style="width:90%; text-align:right; font-size:14px; color:#555; margin-bottom:15px;">
        <input type="checkbox" onclick="togglePasswordCheckbox()" style="margin-left:5px;" />
        Ø¥Ø¸Ù‡Ø§Ø± ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
      </label>
      
      <button onclick="checkLogin()" 
              style="width:90%; padding:12px; background:#2980b9; color:white; border:none; border-radius:10px; font-size:16px; font-weight:bold; cursor:pointer;">
        Ø¯Ø®ÙˆÙ„
      </button>
      
      <p id="loginError" style="color:#e74c3c; margin-top:15px; display:none; font-weight:bold;">âŒ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©</p>
    </div>
  </div>
</div>

<!-- ØªØ±ÙƒÙŠØ² ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù„Ù‰ Ø®Ø§Ù†Ø© Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø© -->

<script>
  window.addEventListener("load", () => {
    setTimeout(() => {
      const input = document.getElementById("loginUsername");
      if (input) input.focus();
    }, 300); // ØªØ£Ø®ÙŠØ± Ø¨Ø³ÙŠØ· Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ ÙƒÙ„ Ø§Ù„Ø¹Ù†Ø§ØµØ±
  });
</script>











<!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ù†ÙŠÙ‚Ø© -->
<div id="statisticsModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:#000000aa; justify-content:center; align-items:center; z-index:9999;">
  <div style="background:#fff; padding:30px; border-radius:12px; box-shadow:0 0 15px #000; max-width:700px; width:90%; max-height:90vh; overflow-y:auto; font-family:'Segoe UI'; position:relative; text-align:center;">
    <h2 style="margin-bottom:20px;">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</h2>
    <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†: <strong id="stat-total">0</strong></p>
    <p>Ø¹Ø¯Ø¯ Ø§Ù„Ø°ÙƒÙˆØ±: <strong id="stat-male">0</strong></p>
    <p>Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ù†Ø§Ø«: <strong id="stat-female">0</strong></p>

    <div id="cityStats" style="
      margin-top: 20px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 12px;
      justify-items: center;
    ">
      <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª Ø³ØªÙØ¶Ø§Ù Ù‡Ù†Ø§ -->
    </div>

    <button onclick="document.getElementById('statisticsModal').style.display='none'" 
      style="margin-top:20px; padding:10px 20px; border:none; background:#007bff; color:white; border-radius:8px; cursor:pointer;">
      Ø¥ØºÙ„Ø§Ù‚
    </button>
  </div>
</div>





<div id="settingsModal" style="display:none; position: fixed; z-index: 2000; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.5);">
  <div style="background: white; max-width: 400px; margin: 100px auto; padding: 20px; border-radius: 10px; text-align: center; position: relative;">
    <span onclick="closeSettingsModal()" 
          style="position: absolute; top: 10px; left: 15px; font-size: 24px; cursor: pointer;">&times;</span>
    <h3>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
    <button onclick="showStatistics()" style="margin:10px; padding: 10px 15px;">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
    <button onclick="exportData()" style="margin:10px; padding: 10px 15px;">â¬‡ï¸ ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª</button>
    <button onclick="importData()" style="margin:10px; padding: 10px 15px;">â¬†ï¸ Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</button>
    <button onclick="logout()" style="margin:10px; padding: 10px 15px; background-color: #e74c3c; color: white;">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
  </div>
</div>









<div id="successMessage" style="display:none;"></div>

  <div class="section">
    <div class="form-row">
      <div class="form-group">
        <label for="name"></label>
        <input type="text" id="name" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù…" />
      </div>
      <div class="form-group">
        <label for="gender"></label>
        <select id="gender">
          <option value="">Ø¬Ù†Ø³</option>
          <option value="Ø°ÙƒØ±">Ø°ÙƒØ±</option>
          <option value="Ø£Ù†Ø«Ù‰">Ø£Ù†Ø«Ù‰</option>
        </select>
      </div>
 <div class="form-group">
  <label for="city"></label>
  <select id="city">
<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</option>
  <option value="Ø¨ØºØ¯Ø§Ø¯">Ø¨ØºØ¯Ø§Ø¯</option>
  <option value="Ø§Ù„Ø¨ØµØ±Ø©">Ø§Ù„Ø¨ØµØ±Ø©</option>
  <option value="Ø§Ù„Ù†Ø¬Ù">Ø§Ù„Ù†Ø¬Ù</option>
  <option value="ÙƒØ±Ø¨Ù„Ø§Ø¡">ÙƒØ±Ø¨Ù„Ø§Ø¡</option>
  <option value="Ø§Ù„Ù†Ø§ØµØ±ÙŠØ©">Ø§Ù„Ù†Ø§ØµØ±ÙŠØ©</option>
  <option value="Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ©">Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ©</option>
  <option value="Ø£Ø±Ø¨ÙŠÙ„">Ø£Ø±Ø¨ÙŠÙ„</option>
  <option value="Ø¯Ù‡ÙˆÙƒ">Ø¯Ù‡ÙˆÙƒ</option>
  <option value="ØµÙ„Ø§Ø­ Ø§Ù„Ø¯ÙŠÙ†">ØµÙ„Ø§Ø­ Ø§Ù„Ø¯ÙŠÙ†</option>
  <option value="Ø§Ù„Ø£Ù†Ø¨Ø§Ø±">Ø§Ù„Ø£Ù†Ø¨Ø§Ø±</option>
  <option value="ÙƒØ±ÙƒÙˆÙƒ">ÙƒØ±ÙƒÙˆÙƒ</option>
  <option value="Ø¯ÙŠØ§Ù„Ù‰">Ø¯ÙŠØ§Ù„Ù‰</option>
  <option value="Ù…ÙŠØ³Ø§Ù†">Ù…ÙŠØ³Ø§Ù†</option>
  <option value="ÙˆØ§Ø³Ø·">ÙˆØ§Ø³Ø·</option>
  <option value="Ø°ÙŠ Ù‚Ø§Ø±">Ø°ÙŠ Ù‚Ø§Ø±</option>
  <option value="Ø­Ù„Ø¨Ø¬Ø©">Ø­Ù„Ø¨Ø¬Ø©</option>
  <option value="Ù†ÙŠÙ†ÙˆÙ‰">Ù†ÙŠÙ†ÙˆÙ‰</option>
  <option value="Ø¨Ø§Ø¨Ù„">Ø¨Ø§Ø¨Ù„</option>
  <option value="Ø§Ù„Ù…Ø«Ù†Ù‰">Ø§Ù„Ù…Ø«Ù†Ù‰</option>
</select>
</div>

      <div class="form-group">
        <label for="birth"></label>
        <input type="date" id="birth" />
      </div>
      <div class="form-group" style="align-self: flex-end;">
      <button id="addEmployee" onclick="addEmployee()">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸Ù</button>

      </div>
    </div>
  </div>

  <div class="section">
    <h3></h3>
    <div class="form-row">
<div style="position: relative; display: inline-block;">
<input
  type="text"
  id="searchName"
  oninput="onSearchInput()"
  placeholder="Ø§ÙƒØªØ¨ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø§Ø³Ù… Ù„Ù„Ø¨Ø­Ø«"
  style="padding-left: 0px; height: 44px; box-sizing: border-box; width: 250px; margin-top: 4px;"
/>
  <span
    id="clearSearch"
    onclick="clearSearchField()"
    style="
      position: absolute;
      left: 15px;
      top: 40%;
      transform: translateY(-50%);
      cursor: pointer;
      font-weight: bold;
      font-size: 18px;
      color: #888;
      user-select: none;
      display: none;
    "
    title="Ù…Ø³Ø­"
  >
   X
  </span>
</div>


      <div class="form-group">
        <label for="filterGender"></label>
        <select id="filterGender" onchange="filterAndShow()">
          <option value=""> Ø§Ù„Ø¬Ù†Ø³ Ø§Ù„Ù…Ø³Ø¬Ù„Ø© </option>
          <option value="Ø°ÙƒØ±">Ø°ÙƒØ±</option>
          <option value="Ø£Ù†Ø«Ù‰">Ø£Ù†Ø«Ù‰</option>
        </select>
      </div>

      <div class="form-group">
        <label for="filterCity"></label>
        <select id="filterCity" onchange="filterAndShow()">
          <option value="">Ø§Ù„Ù…Ø¯Ù† Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</option>
          <option value="Ø£Ø±Ø¨ÙŠÙ„">Ø£Ø±Ø¨ÙŠÙ„</option>
          <option value="Ø¯Ù‡ÙˆÙƒ">Ø¯Ù‡ÙˆÙƒ</option>
        </select>
      </div>

      <div class="form-group">
        <label for="filterBirthSelect"></label>
        <select id="filterBirthSelect" onchange="filterAndShow()">
          <option value="">Ø§Ø®ØªØ± ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</option>
        </select>
      </div>
    </div>
  </div>

<div id="matchingNamesList" style="position: relative;">
  <ul id="matchingNames" style="
    list-style: none;
    margin: 0; padding: 0;
    background: white;
    border: 1px solid #ccc;
    max-height: 150px;
    overflow-y: auto;
    width: 100%;
    box-sizing: border-box;
    cursor: pointer;
    display: none;
    position: absolute;
    z-index: 1000;
  ">
  </ul>
</div>




<div style="display: flex; align-items: center; justify-content: center; margin-top: 10px; gap: 20px;">

  <!-- Ø²Ø± Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ† -->
  <button id="openSettingsBtn" style="padding: 10px 20px; font-weight: bold;">
    âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
  </button>


  <!-- Ø§Ù„Ù†Øµ ÙÙŠ Ø§Ù„ÙˆØ³Ø· Ù…Ø¹ Ø¯ÙØ¹Ù‡ ÙŠÙ…ÙŠÙ† Ø´ÙˆÙŠ -->
  <div id="countDisplay" style="font-weight: bold; color: #2980b9; text-align: center; margin-left: 40px; min-width: 150px;">
    Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†: 0 <br/>
    Ù…Ù† Ø¨Ø¹Ø«: 0
  </div>

</div>








</div>


<div id="countDisplay" style="margin-top: 10px; font-weight: bold;"></div>

</div>
  <div class="table-container">
    <table id="employeeTable">
      <thead>
        <tr>
          <th>Ø§Ù„Ø±Ù‚Ù…</th>
          <th>Ø§Ù„Ø§Ø³Ù…</th>
          <th>Ø§Ù„Ø¬Ù†Ø³</th>
          <th>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</th>
          <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</th>
          <th>Ø§Ù„ÙŠÙˆÙ…</th>
          <th>Ø§Ù„ÙˆÙ‚Øª</th>
          <th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„</th>
          <th>ØªØ­ÙƒÙ…</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù -->
<div id="detailsModal" style="display:none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5);">
  <div style="background: white; width: 350px; margin: 100px auto; padding: 20px; border-radius: 10px; position: relative; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
    <span style="position: absolute; top: 10px; left: 15px; font-size: 22px; cursor: pointer;" onclick="closeDetailsModal()">&times;</span>
    <div id="detailsContent"></div>
    <button onclick="printCurrentDetails()" style="margin-top: 15px; width: 100%; padding: 10px; font-weight: bold; background-color: #3498db; color: white; border: none; border-radius: 6px; cursor: pointer;">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
  </div>
</div>





  <!-- Ù†Ø§ÙØ°Ø© ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù -->
  <div id="editModal">
    <div id="editModalContent">
      <span class="closeBtn" onclick="closeEditModal()">&times;</span>
      <h3>ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù</h3>
      <form id="editForm" onsubmit="saveEdit(event)">
        <input type="text" id="editName" required placeholder="Ø§Ù„Ø§Ø³Ù…"/>
        <select id="editGender" required>
          <option value="Ø°ÙƒØ±">Ø°ÙƒØ±</option>
          <option value="Ø£Ù†Ø«Ù‰">Ø£Ù†Ø«Ù‰</option>
        </select>
<select id="editCity" required>
  <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</option>
  <option value="Ø¨ØºØ¯Ø§Ø¯">Ø¨ØºØ¯Ø§Ø¯</option>
  <option value="Ø§Ù„Ø¨ØµØ±Ø©">Ø§Ù„Ø¨ØµØ±Ø©</option>
  <option value="Ø§Ù„Ù†Ø¬Ù">Ø§Ù„Ù†Ø¬Ù</option>
  <option value="ÙƒØ±Ø¨Ù„Ø§Ø¡">ÙƒØ±Ø¨Ù„Ø§Ø¡</option>
  <option value="Ø§Ù„Ù†Ø§ØµØ±ÙŠØ©">Ø§Ù„Ù†Ø§ØµØ±ÙŠØ©</option>
  <option value="Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ©">Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ©</option>
  <option value="Ø£Ø±Ø¨ÙŠÙ„">Ø£Ø±Ø¨ÙŠÙ„</option>
  <option value="Ø¯Ù‡ÙˆÙƒ">Ø¯Ù‡ÙˆÙƒ</option>
  <option value="ØµÙ„Ø§Ø­ Ø§Ù„Ø¯ÙŠÙ†">ØµÙ„Ø§Ø­ Ø§Ù„Ø¯ÙŠÙ†</option>
  <option value="Ø§Ù„Ø£Ù†Ø¨Ø§Ø±">Ø§Ù„Ø£Ù†Ø¨Ø§Ø±</option>
  <option value="ÙƒØ±ÙƒÙˆÙƒ">ÙƒØ±ÙƒÙˆÙƒ</option>
  <option value="Ø¯ÙŠØ§Ù„Ù‰">Ø¯ÙŠØ§Ù„Ù‰</option>
  <option value="Ù…ÙŠØ³Ø§Ù†">Ù…ÙŠØ³Ø§Ù†</option>
  <option value="ÙˆØ§Ø³Ø·">ÙˆØ§Ø³Ø·</option>
  <option value="Ø°ÙŠ Ù‚Ø§Ø±">Ø°ÙŠ Ù‚Ø§Ø±</option>
  <option value="Ø­Ù„Ø¨Ø¬Ø©">Ø­Ù„Ø¨Ø¬Ø©</option>
  <option value="Ù†ÙŠÙ†ÙˆÙ‰">Ù†ÙŠÙ†ÙˆÙ‰</option>
  <option value="Ø¨Ø§Ø¨Ù„">Ø¨Ø§Ø¨Ù„</option>
  <option value="Ø§Ù„Ù…Ø«Ù†Ù‰">Ø§Ù„Ù…Ø«Ù†Ù‰</option>
</select>
        <input type="date" id="editBirth" required/>
        <button type="submit">Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„</button>
      </form>
    </div>
  </div>

<script>
  let db;
  const request = indexedDB.open("EmployeeDB", 1);

  let editingId = null;

  request.onupgradeneeded = function(e) {
    db = e.target.result;
    if (!db.objectStoreNames.contains("employees")) {
      db.createObjectStore("employees", { keyPath: "id", autoIncrement: true });
    }
  };

  request.onsuccess = function(e) {
    db = e.target.result;
    updateBirthDatesDropdown();
    filterAndShow();
  };


function addEmployee() {
  const name = document.getElementById("name").value.trim();
  const gender = document.getElementById("gender").value;
  const city = document.getElementById("city").value;
  const birth = document.getElementById("birth").value;

  if (!name || !birth) {
    alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„.");
    return;
  }

  const now = new Date();
  const weekday = now.toLocaleDateString("ar-EG", { weekday: "long" });
  const time = now.toLocaleTimeString("ar-EG");
const year = now.getFullYear();
const month = (now.getMonth() + 1).toString().padStart(2, '0');
const day = now.getDate().toString().padStart(2, '0');
const regDate = `${year}-${month}-${day}`; // Ø§Ù„ØªØ§Ø±ÙŠØ® Ø¨ØµÙŠØºØ© Ù…Ø­Ù„ÙŠØ© ØµØ­ÙŠØ­Ø©


  const tx = db.transaction("employees", "readwrite");
  const store = tx.objectStore("employees");

  const employee = {
    name,
    gender,
    city,
    birth,
    weekday,
    time,
    regDate
  };

  const requestAdd = store.add(employee);

  requestAdd.onsuccess = (event) => {
    const newId = event.target.result;
    showSuccessMessage("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…ÙˆØ¸Ù " + name + " Ø¨Ù†Ø¬Ø§Ø­.");
    updateBirthDatesDropdown();
    filterAndShow();
    clearForm();
    printA5(newId); // â† Ø·Ø¨Ø§Ø¹Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
  };

  requestAdd.onerror = (e) => {
    alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…ÙˆØ¸Ù. Ø±Ø¨Ù…Ø§ Ø§Ù„Ø§Ø³Ù… Ù…ÙƒØ±Ø± Ø£Ùˆ Ù‡Ù†Ø§Ùƒ Ù…Ø´ÙƒÙ„Ø©.");
    console.error("Add Error:", e.target.error);
  };
}



 


  function clearForm() {
    document.getElementById("name").value = "";
    document.getElementById("gender").value = "";
    document.getElementById("city").value = "";
    document.getElementById("birth").value = "";
  }

  function renderRow(emp) {
    const tbody = document.querySelector("#employeeTable tbody");
    const row = document.createElement("tr");

    row.innerHTML = `
      <td>${emp.id}</td>
      <td>${emp.name}</td>
      <td>${emp.gender}</td>
      <td>${emp.city}</td>
      <td>${emp.birth}</td>
      <td>${emp.weekday}</td>
      <td>${emp.time}</td>
      <td>${emp.regDate}</td>
      <td>
        <button class="btn-small btn-edit" onclick="editEmployee(${emp.id})">ØªØ¹Ø¯ÙŠÙ„</button>
        <button class="btn-small btn-delete" onclick="deleteEmployee(${emp.id})">Ø­Ø°Ù</button>
        <button class="btn-small btn-details" onclick="showDetails(${emp.id})">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</button>
        <button class="btn-small btn-print" onclick="printA5(${emp.id})">Ø·Ø¨Ø§Ø¹Ø©</button>
      </td>
    `;
    tbody.appendChild(row);
  }

 function deleteEmployee(id) {
  const tx = db.transaction("employees", "readonly");
  const store = tx.objectStore("employees");
  const request = store.get(id);
  request.onsuccess = () => {
    const emp = request.result;
    if (!emp) {
      alert("Ø§Ù„Ù…ÙˆØ¸Ù ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯!");
      return;
    }
    const confirmMsg = `Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ù…ÙˆØ¸Ù: ${emp.name} ØŸ`;
    if (confirm(confirmMsg)) {
      const txDelete = db.transaction("employees", "readwrite");
      const storeDelete = txDelete.objectStore("employees");
      storeDelete.delete(id);
      txDelete.oncomplete = () => {
        updateBirthDatesDropdown();
        filterAndShow();
      };
    }
  };
  request.onerror = () => {
    alert("Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù Ù„Ù„Ø­Ø°Ù.");
  };
}


  function editEmployee(id) {
    const tx = db.transaction("employees", "readonly");
    const store = tx.objectStore("employees");
    const request = store.get(id);
    request.onsuccess = () => {
      const emp = request.result;
      document.getElementById("editName").value = emp.name;
      document.getElementById("editGender").value = emp.gender;
      document.getElementById("editCity").value = emp.city;
      document.getElementById("editBirth").value = emp.birth;
      editingId = emp.id;
      document.getElementById("editModal").style.display = "block";
    };
  }

  function closeEditModal() {
    document.getElementById("editModal").style.display = "none";
    editingId = null;
  }







  function showDetails(id) {
    const tx = db.transaction("employees", "readonly");
    const store = tx.objectStore("employees");
    const request = store.get(id);
    request.onsuccess = () => {
      const emp = request.result;
      alert(
        `Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù:\n\n` +
        `Ø§Ù„Ø§Ø³Ù…: ${emp.name}\n` +
        `Ø§Ù„Ø¬Ù†Ø³: ${emp.gender}\n` +
        `Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©: ${emp.city}\n` +
        `ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯: ${emp.birth}\n` +
        `Ø§Ù„ÙŠÙˆÙ…: ${emp.weekday}\n` +
        `Ø§Ù„ÙˆÙ‚Øª: ${emp.time}\n` +
        `ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„: ${emp.regDate}`
      );
    };
  }

 function printA5(id) {
  const tx = db.transaction("employees", "readonly");
  const store = tx.objectStore("employees");
  const request = store.get(id);

  request.onsuccess = () => {
    const emp = request.result;

    const printWindow = window.open('', '', 'width=600,height=800'); // Ø­Ø¬Ù… Ø£ÙƒØ¨Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹ Ù…Ù† A5

    printWindow.document.write(`
      <html dir="rtl">
        <head>
          <title>Ø·Ø¨Ø§Ø¹Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù</title>
          <style>
            body {
              font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
              padding: 40px;
              font-size: 16px;
              direction: rtl;
              text-align: right;
            }
            h2 {
              text-align: center;
              margin-bottom: 30px;
            }
            p {
              margin: 10px 0;
              border-bottom: 1px dashed #ccc;
              padding-bottom: 5px;
            }
            strong {
              display: inline-block;
              width: 150px;
            }
          </style>
        </head>
        <body>
          <h2>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù</h2>
          <p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${emp.name}</p>
          <p><strong>Ø§Ù„Ø¬Ù†Ø³:</strong> ${emp.gender}</p>
          <p><strong>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</strong> ${emp.city}</p>
          <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯:</strong> ${emp.birth}</p>
          <p><strong>Ø§Ù„ÙŠÙˆÙ…:</strong> ${emp.weekday}</p>
          <p><strong>Ø§Ù„ÙˆÙ‚Øª:</strong> ${emp.time}</p>
          <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</strong> ${emp.regDate}</p>
        </body>
      </html>
    `);

    printWindow.document.close();
    printWindow.focus();
    printWindow.print();
    printWindow.close();
  };
}


  // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø¨Ø´ÙƒÙ„ ÙØ±ÙŠØ¯)
  function updateBirthDatesDropdown() {
    const tx = db.transaction("employees", "readonly");
    const store = tx.objectStore("employees");
    store.getAll().onsuccess = (e) => {
      const employees = e.target.result;
      const births = new Set(employees.map(emp => emp.birth).filter(b => b));
      const select = document.getElementById("filterBirthSelect");
      const currentVal = select.value;

      // Ù†Ø¸Ù Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
      while (select.options.length > 1) {
        select.remove(1);
      }

      Array.from(births).sort().forEach(b => {
        const opt = document.createElement("option");
        opt.value = b;
        opt.textContent = b;
        select.appendChild(opt);
      });

      // Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø¥Ø°Ø§ Ù…Ø§Ø²Ø§Ù„ Ù…ÙˆØ¬ÙˆØ¯
      if (births.has(currentVal)) {
        select.value = currentVal;
      } else {
        select.value = "";
      }
    };
  }

  // Ø¯Ø§Ù„Ø© Ø§Ù„ØªØµÙÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Ø¨Ø­Ø« + ÙÙ„ØªØ±Ø© + ØªØ­Ø¯ÙŠØ« Ù‚ÙˆØ§Ø¦Ù…)


  function updateDropdownsBasedOn(employees) {
    const genders = new Set();
    const cities = new Set();
    const births = new Set();

    employees.forEach(emp => {
      if(emp.gender) genders.add(emp.gender);
      if(emp.city) cities.add(emp.city);
      if(emp.birth) births.add(emp.birth);
    });

    fillSelect("filterGender", genders);
    fillSelect("filterCity", cities);
    fillSelect("filterBirthSelect", births);
  }

  function fillSelect(id, items) {
    const select = document.getElementById(id);
    const currentValue = select.value;
    while (select.options.length > 1) {
      select.remove(1);
    }
    Array.from(items).sort().forEach(item => {
      const opt = document.createElement("option");
      opt.value = item;
      opt.textContent = item;
      select.appendChild(opt);
    });
    if (items.has(currentValue)) {
      select.value = currentValue;
    } else {
      select.value = "";
    }
  }
function showSuccessMessage(msg) {
  const messageDiv = document.getElementById("successMessage");
  messageDiv.textContent = msg;
  messageDiv.style.display = "block";
  messageDiv.style.opacity = "1";
  
  setTimeout(() => {
    messageDiv.style.opacity = "0";
    setTimeout(() => {
      messageDiv.style.display = "none";
    }, 400);
  }, 3000); // ØªØ®ØªÙÙŠ Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†Ù
}


function saveEdit(event) {
  event.preventDefault();
  const name = document.getElementById("editName").value.trim();
  const gender = document.getElementById("editGender").value;
  const city = document.getElementById("editCity").value;
  const birth = document.getElementById("editBirth").value;

  if (!name || !birth) {
    alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„.");
    return;
  }

const now = new Date();
const weekday = now.toLocaleDateString("ar-EG", { weekday: "long" }); // Ø§Ø³Ù… Ø§Ù„ÙŠÙˆÙ… Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØŒ ØµØ­ÙŠØ­
const time = now.toLocaleTimeString("ar-EG");

const year = now.getFullYear();
const month = (now.getMonth() + 1).toString().padStart(2, '0');
const day = now.getDate().toString().padStart(2, '0');
const regDate = `${year}-${month}-${day}`; // ØªØ§Ø±ÙŠØ® Ù…Ø­Ù„ÙŠ ØµØ­ÙŠØ­





  const tx = db.transaction("employees", "readwrite");
  const store = tx.objectStore("employees");
  const employee = {
    id: editingId,
    name,
    gender,
    city,
    birth,
    weekday,
    time,
    regDate
  };

  store.put(employee);
  tx.oncomplete = () => {
    showSuccessMessage("ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù " + name + " Ø¨Ù†Ø¬Ø§Ø­.");
    updateBirthDatesDropdown();
    closeEditModal();
    filterAndShow();
  };
}





function showDetails(id) {
  const tx = db.transaction("employees", "readonly");
  const store = tx.objectStore("employees");
  const request = store.get(id);
  request.onsuccess = () => {
    const emp = request.result;
    const detailsContent = document.getElementById("detailsContent");
    detailsContent.innerHTML = `
      <h3 style="text-align:center; margin-bottom: 15px;">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù</h3>
      <p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> ${emp.name}</p>
      <p><strong>Ø§Ù„Ø¬Ù†Ø³:</strong> ${emp.gender}</p>
      <p><strong>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</strong> ${emp.city}</p>
      <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯:</strong> ${emp.birth}</p>
      <p><strong>Ø§Ù„ÙŠÙˆÙ…:</strong> ${emp.weekday}</p>
      <p><strong>Ø§Ù„ÙˆÙ‚Øª:</strong> ${emp.time}</p>
      <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</strong> ${emp.regDate}</p>
    `;
    document.getElementById("detailsModal").style.display = "block";
  };
}

function closeDetailsModal() {
  document.getElementById("detailsModal").style.display = "none";
}

function printCurrentDetails() {
  const detailsContent = document.getElementById("detailsContent").innerHTML;
  const printWindow = window.open('', '', 'width=800,height=600');

  printWindow.document.write(`
    <html dir="rtl">
      <head>
        <title>Ø·Ø¨Ø§Ø¹Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ¸Ù</title>
        <style>
          body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px; }
          h3 { text-align: center; }
          p { font-size: 16px; }
        </style>
      </head>
      <body>${detailsContent}</body>
    </html>
  `);
  printWindow.document.close();
  printWindow.focus();
  printWindow.print();
  printWindow.close();
}

// Ø²Ø± ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø©
document.getElementById('openSettingsBtn').addEventListener('click', () => {
  document.getElementById('settingsModal').style.display = 'block';
});

// Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©
function closeSettingsModal() {
  document.getElementById('settingsModal').style.display = 'none';
}

// Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª

function filterAndShow() {
  const nameInput = document.getElementById("searchName").value.trim().toLowerCase();
  const firstChar = nameInput ? nameInput[0] : "";
  const genderFilter = document.getElementById("filterGender").value;
  const cityFilter = document.getElementById("filterCity").value;
  const birthFilter = document.getElementById("filterBirthSelect").value;

  const tx = db.transaction("employees", "readonly");
  const store = tx.objectStore("employees");
  store.getAll().onsuccess = (e) => {
    let employees = e.target.result;

    // ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„Ø§Øª
    if (firstChar) {
      employees = employees.filter(emp => emp.name.toLowerCase().startsWith(firstChar));
    }
    if (genderFilter) {
      employees = employees.filter(emp => emp.gender === genderFilter);
    }
    if (cityFilter) {
      employees = employees.filter(emp => emp.city === cityFilter);
    }
    if (birthFilter) {
      employees = employees.filter(emp => emp.birth === birthFilter);
    }

    updateDropdownsBasedOn(employees);

    const tbody = document.querySelector("#employeeTable tbody");
    tbody.innerHTML = "";

    // âœ… Ø¹Ø±Ø¶ ÙÙ‚Ø· Ø£ÙˆÙ„ 200 Ù†ØªÙŠØ¬Ø©
    let limitedEmployees = employees.slice(0, 200);
    limitedEmployees.forEach(emp => renderRow(emp));

    // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ø·Ø§Ø¨Ù‚Ø©
    updateMatchingNamesList(employees, nameInput);

    // Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
    const allEmployees = e.target.result;
    let displayParts = [];

    if (!firstChar && !cityFilter && !genderFilter && !birthFilter) {
      displayParts.push(`Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†: ${allEmployees.length}`);
    } else {
      if (firstChar) {
        const countName = allEmployees.filter(emp => emp.name.toLowerCase().startsWith(firstChar)).length;
        displayParts.push(`Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø³Ù…: ${countName}`);
      }
      if (cityFilter) {
        const countCity = allEmployees.filter(emp => emp.city === cityFilter).length;
        displayParts.push(`Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©: ${countCity}`);
      }
      if (genderFilter) {
        const countGender = allEmployees.filter(emp => emp.gender === genderFilter).length;
        displayParts.push(`Ø§Ù„Ø¬Ù†Ø³: ${countGender}`);
      }
      if (birthFilter) {
        const countBirth = allEmployees.filter(emp => emp.birth === birthFilter).length;
        displayParts.push(`ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯: ${countBirth}`);
      }
    }

    document.getElementById("countDisplay").textContent = displayParts.join(" | ");
  };
}

function adjustMatchingNamesWidth() {
  const matchingNames = document.getElementById("matchingNames");
  if (window.innerWidth <= 1366) { // Ø´Ø§Ø´Ø© Ù„Ø§Ø¨ØªÙˆØ¨ Ø£Ùˆ Ø£ØµØºØ±
    matchingNames.style.width = "200px";
  } else {
    matchingNames.style.width = "100%";
  }
}

window.addEventListener('resize', adjustMatchingNamesWidth);
window.addEventListener('load', adjustMatchingNamesWidth);


// ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ù…Ù„Ù JSON
function exportData() {
  const request = indexedDB.open('EmployeeDB', 1);
  request.onsuccess = function (event) {
    const db = event.target.result;
    const transaction = db.transaction(['employees'], 'readonly');
    const store = transaction.objectStore('employees');
    const getAll = store.getAll();

    getAll.onsuccess = function () {
      const data = JSON.stringify(getAll.result, null, 2);
      const blob = new Blob([data], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'employees_backup.json';
      a.click();
      URL.revokeObjectURL(url);
    };
  };
}

// Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù…Ù„Ù JSON
function importData() {
  const input = document.createElement('input');
  input.type = 'file';
  input.accept = 'application/json';
  input.onchange = function (event) {
    const file = event.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = function (e) {
      try {
        const data = JSON.parse(e.target.result);
        const request = indexedDB.open('EmployeeDB', 1);
        request.onsuccess = function (event) {
          const db = event.target.result;
          const transaction = db.transaction(['employees'], 'readwrite');
          const store = transaction.objectStore('employees');

          data.forEach(emp => {
            store.put(emp); // store.add(emp) Ø¥Ø°Ø§ ØªØ±ÙŠØ¯ Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±
          });

          transaction.oncomplete = function () {
            alert('âœ… ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!');
            // location.reload(); âŒ
            filterAndShow(); // âœ… Ø¨Ø¯ÙŠÙ„ ØµØ­ÙŠØ­ ÙˆÙ…ÙˆØ¬ÙˆØ¯

          };
        };
      } catch (err) {
        alert('âŒ ÙØ´Ù„ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù. ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© ØªÙ†Ø³ÙŠÙ‚Ù‡.');
        console.error(err);
      }
    };
    reader.readAsText(file);
  };
  input.click();
}

// Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬

  function logout() {
  closeSettingsModal();
  location.reload();
}




function checkLogin() {
  const username = document.getElementById("loginUsername").value.trim();
  const password = document.getElementById("loginPassword").value;

  const correctUsername = "Ø§Ø­Ù…Ø¯";
  const correctPassword = "1234";

  if (username === correctUsername && password === correctPassword) {
    document.getElementById("loginModal").style.display = "none";
  } else {
    const errorMsg = document.getElementById("loginError");
    errorMsg.style.display = "block";
    setTimeout(() => {
      errorMsg.style.display = "none";
    }, 3000);
  }
}



function closeSettingsModal() {
  const settings = document.getElementById("settingsModal");
  if (settings) settings.style.display = "none";
}





// Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ù†Ø®ÙÙŠ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ø­ØªÙ‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„)
window.onload = function() {
  document.getElementById("mainContent").style.display = "none";
  document.getElementById("loginModal").style.display = "flex";
}

let nameSelected = false;

function updateMatchingNamesList(employees, searchText) {
  const list = document.getElementById("matchingNames");
  list.innerHTML = "";

  if (!searchText || nameSelected) {
    list.style.display = "none";
    return;
  }

  const matchedNamesSet = new Set();

  employees.forEach(emp => {
    if (emp.name.toLowerCase().startsWith(searchText)) {
      matchedNamesSet.add(emp.name);
    }
  });

  if (matchedNamesSet.size === 0) {
    list.style.display = "none";
    return;
  }

  matchedNamesSet.forEach(name => {
    const li = document.createElement("li");
    li.textContent = name;

    li.onclick = () => {
      nameSelected = true;  // Ù…Ù†Ø¹ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¸Ù‡ÙˆØ±
      document.getElementById("searchName").value = name;
      list.style.display = "none";

      filterAndShow();

      setTimeout(() => {
        nameSelected = false; // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø³Ù…Ø§Ø­ Ù„Ø§Ø­Ù‚Ù‹Ø§
      }, 300);
    };

    list.appendChild(li);
  });

  list.style.display = "block";
}


function fillBaathDataAndHide(name, gender, city, birth) {
  document.getElementById("baathName").value = name;
  document.getElementById("baathGender").value = gender;
  document.getElementById("baathCity").value = city;
  document.getElementById("baathBirth").value = birth;

  // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±
  document.getElementById("resultsList").innerHTML = "";
}

function showStatistics() {
  const iraqiCities = [
    "Ø£Ø±Ø¨ÙŠÙ„", "Ø¯Ù‡ÙˆÙƒ", "Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ©", "Ø¨ØºØ¯Ø§Ø¯", "Ø§Ù„Ø¨ØµØ±Ø©", "Ù†ÙŠÙ†ÙˆÙ‰",
    "ÙƒØ±ÙƒÙˆÙƒ", "Ø§Ù„Ù†Ø¬Ù", "ÙƒØ±Ø¨Ù„Ø§Ø¡", "Ø¯ÙŠØ§Ù„Ù‰", "Ø§Ù„Ø£Ù†Ø¨Ø§Ø±", "Ø°ÙŠ Ù‚Ø§Ø±",
    "ØµÙ„Ø§Ø­ Ø§Ù„Ø¯ÙŠÙ†", "Ù…ÙŠØ³Ø§Ù†", "Ø¨Ø§Ø¨Ù„", "ÙˆØ§Ø³Ø·", "Ø§Ù„Ù…Ø«Ù†Ù‰", "Ø§Ù„Ù†Ø§ØµØ±ÙŠØ©", "Ø­Ù„Ø¨Ø¬Ø©"
  ];
  let total = 0, male = 0, female = 0;
  const cityCounts = {};

  iraqiCities.forEach(city => cityCounts[city] = 0);

  const tx = db.transaction("employees", "readonly");
  const store = tx.objectStore("employees");
  const request = store.getAll();

  request.onsuccess = () => {
    const employees = request.result;
    total = employees.length;

    employees.forEach(emp => {
      if (emp.gender === "Ø°ÙƒØ±") male++;
      if (emp.gender === "Ø£Ù†Ø«Ù‰") female++;
      if (iraqiCities.includes(emp.city)) {
        cityCounts[emp.city]++;
      }
    });

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    document.getElementById("stat-total").textContent = total;
    document.getElementById("stat-male").textContent = male;
    document.getElementById("stat-female").textContent = female;

    // ØªÙˆÙ„ÙŠØ¯ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª Ø§Ù„ØªÙŠ Ù„Ø¯ÙŠÙ‡Ø§ Ù…ÙˆØ¸ÙÙŠÙ†
    const cityStatsDiv = document.getElementById("cityStats");
    cityStatsDiv.innerHTML = ""; // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…Ø­ØªÙˆÙ‰

    iraqiCities.forEach(city => {
      const count = cityCounts[city];
      if (count > 0) {
        const btn = document.createElement("button");
        btn.textContent = `${city} (${count})`;
        btn.style.cssText = `
          padding: 8px 14px;
          background: #007bff;
          color: white;
          border: none;
          border-radius: 8px;
          cursor: default;
          font-weight: bold;
          transition: background-color 0.3s;
          width: 100%;
          box-sizing: border-box;
        `;
        btn.onmouseover = () => btn.style.backgroundColor = "#0056b3";
        btn.onmouseout = () => btn.style.backgroundColor = "#007bff";

        cityStatsDiv.appendChild(btn);
      }
    });

    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø§ÙØ°Ø©
    document.getElementById("statisticsModal").style.display = "flex";
  };
}



function onSearchInput() {
  const input = document.getElementById("searchName");
  const clearBtn = document.getElementById("clearSearch");
  if (input.value.length > 0) {
    clearBtn.style.display = "block";
  } else {
    clearBtn.style.display = "none";
  }
  filterAndShow(); // Ø¥Ø°Ø§ Ø¹Ù†Ø¯Ùƒ Ø¯Ø§Ù„Ø© ÙÙ„ØªØ±Ø©
}

function clearSearchField() {
  const input = document.getElementById("searchName");
  input.value = "";
  document.getElementById("clearSearch").style.display = "none";
  input.focus();
  filterAndShow(); // Ø­Ø¯Ø« Ø§Ù„ÙÙ„ØªØ±Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ù…Ø³Ø­
}

// Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©ØŒ Ø¶Ø¹ Ø§Ù„Ù…Ø¤Ø´Ø± Ø¹Ù„Ù‰ Ø®Ø§Ù†Ø© Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
window.onload = () => {
  document.getElementById("loginUsername").focus();
};

function togglePassword() {
  const passwordInput = document.getElementById("loginPassword");
  const eyeIcon = event.target;

  if (passwordInput.type === "password") {
    passwordInput.type = "text";
    eyeIcon.textContent = "ğŸ™ˆ"; // Ø¹Ù†Ø¯ Ø§Ù„Ø¹Ø±Ø¶
  } else {
    passwordInput.type = "password";
    eyeIcon.textContent = "ğŸ‘"; // Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø®ÙØ§Ø¡
  }
}





// Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„ Ø´ÙŠØ¡ Ø­ØªÙ‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
window.onload = function() {
  document.body.style.display = "none";
  setTimeout(() => {
    document.body.style.display = "block";
  }, 50); // ØªØ£Ø®ÙŠØ± Ø¨Ø³ÙŠØ· Ù„Ø¥Ø¸Ù‡Ø§Ø± loginModal
};



window.onload = function () {
  const nameInput = document.getElementById("name");
  const genderInput = document.getElementById("gender");
  const cityInput = document.getElementById("city");
  const birthInput = document.getElementById("birth");
  const saveBtn = document.getElementById("addEmployee");

  // Ø¶Ø¹ Ø§Ù„ØªØ±ÙƒÙŠØ² ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ø³Ù…
  nameInput.focus();

  // Ø§Ù†ØªÙ‚Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨ÙŠÙ† Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø¨Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter
  nameInput.addEventListener("keydown", function (e) {
    if (e.key === "Enter") {
      e.preventDefault();
      genderInput.focus();
    }
  });

  genderInput.addEventListener("keydown", function (e) {
    if (e.key === "Enter") {
      e.preventDefault();
      cityInput.focus();
    }
  });

  cityInput.addEventListener("keydown", function (e) {
    if (e.key === "Enter") {
      e.preventDefault();
      birthInput.focus();
    }
  });

  birthInput.addEventListener("keydown", function (e) {
    if (e.key === "Enter") {
      e.preventDefault();
      saveBtn.click(); // Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠ
    }
  });
};


// ØªÙØ¹ÙŠÙ„ Ø²Ø± "Ø¯Ø®ÙˆÙ„" Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter Ø¯Ø§Ø®Ù„ Ø®Ø§Ù†Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
document.getElementById("loginPassword").addEventListener("keypress", function(e) {
  if (e.key === "Enter") {
    checkLogin(); // Ù†ÙØ³ Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙŠ ØªØ¶ØºØ· Ø¹Ù„ÙŠÙ‡Ø§ ÙÙŠ Ø§Ù„Ø²Ø±
  }
});

function togglePasswordCheckbox() {
  const passwordInput = document.getElementById("loginPassword");
  passwordInput.type = passwordInput.type === "password" ? "text" : "password";
}

document.getElementById('loginUsername').addEventListener('keydown', function(e) {
  if (e.key === 'Enter') {
    e.preventDefault();
    document.getElementById('loginPassword').focus();
  }
});




</script>

</body>
</html>